<h1 align='center'> Применение Методов Машинного Обучения для Определения
Концентрации Бактерий и их Классификации </h1>

<style>
    p {
        text-indent: 15px;
    }
</style>

<br>

<p align='right'><b>Автор проекта: Жамков Н. Д.</b></p>
<p align='right'><b>Наставник: Дьяконов А. В.</b></p>

<p align='justify'>
В современном мире проблема быстрого и точного определения концентрации и типа различных бактерий является значимой в сферах медицины и пищевой промышленности. В настоящее время для этих целей часто применяется классический метод Коха, который, хотя и является стандартным в данной области, подвергается критике за свою низкую скорость детекции (24-48 часов).
В этой связи, крайне актуальна разработка более эффективных методов детекции. В своей исследовательской работе мы предлагаем инновационный метод, направленный на определение концентрации и типа бактерий с использованием передовых технологий машинного обучения. 
Предлагаемый метод способен не только решить эту проблему, но и внести существенный вклад в улучшение процессов детекции и классификации бактерий. В данной работе проведен анализ существующих методик детекции и выявлены их недостатки. Описаны преимущества нового подхода, основанного на использовании технологий машинного обучения, обеспечивающим высокую точность результатов и значительное сокращение процесса, с 24-48 часов до ~1 часа. 
Целью исследования является разработка и реализация метода определения концентрации бактерий и их классификации с использованием технологий машинного обучения. В рамках данного проекта проведен анализ различных моделей машинного обучения и выявление модели с наилучшими результатами детекции.
</p>

В работе:
1.  Проведен анализ существующих методов определения концентрации и типа бактерий.
2.  Собраны характеристики ВАХ сред с различными штаммами бактерий и составлены базы данных.
3.  Выявлены оптимальные модели машинного обучения для определения концентрации бактерий и их классификации. Подобраны параметры алгоритмов машинного обучения.
4.  Проведены сравнения метрик оценки моделей.

<p align='justify'>
Доказана гипотеза, что использование модели машинного обучения в качестве способа определения концентрации бактерий и их типов значительно ускоряет процесс детекции, сохраняя точность, сравнимую с общепринятыми стандартами (методом Коха). 
Обученная нами модель может легко интегрироваться в производственные процессы пищевой промышленности, позволяя с высокой скоростью и точностью определять концентрацию микроорганизмов в сырье и продукции. Процесс детекции будет занимать менее часа, при точности определения концентрации и типа бактерии >98%, что в результате будет способствовать значительному уменьшению риска заболеваний и осложнений, вызываемых болезнетворными микроорганизмами
</p>

<br>

<h1 align='center'>Классический Метод Коха</h1>

<p>Метод Коха представляет собой последовательные разведения исследуемого материала в 
расплавленном агаре с последующим переносом агара с разведенной культурой в чашку Петри.</p>

<p align='center'><img src='images/koha.png' width=400></img></p>

<p align='justify'>Однако, несмотря на свою широкую применимость и точность, классический метод Коха
обладает значительным недостатком в виде продолжительного времени выполнения. В условиях, 
где требуется оперативный и точный анализ концентрации патогенных микроорганизмов, 
подход, который требует от <b>24 до 48 часов</b>, может оказаться <i>неэффективным и непрактичным</i>.</p>

<br>

<h1 align='center'>Метрики Для Оценки</h1>

<ul>
    <li>Accuracy</li>
    <li>Precision</li>
    <li>Recall</li>
    <li>F1-score</li>
</ul>

<p>Нас больше интересует <b>Recall</b>, так как мы делаем ставку на то, что мы сделаем меньше ошибок для положительного (возможно <i>опасного</i>) класса, нежели просто будем иметь высокую точность в общем.</p>

$$ \large Recall = \frac {TP} {TP + FN} $$

<br>

<h1 align='center'>Вольт-амперные Характеристики</h1>

<p align='justify'><b>Вольт-амперные характеристики (ВАХ)</b> представляют собой зависимость тока от 
напряжения в электрической системе. В контексте исследования бактерий, ВАХ используется, к 
примеру, в электрохимической импедансной спектроскопии (EIS). Этот метод позволяет 
измерять изменения электрического сопротивления в системе, включая биологическую среду с 
микроорганизмами, под воздействием переменного электрического поля.
Учитывая поведение бактерий, использование циклической вольтамперометрии для 
обнаружения и подсчета бактерий может быть эффективным, благодаря своим преимуществам:
быстрый отклик и простое оборудование.
Кондуктометрический метод, такой как EIS, не требует меток в качестве средства 
быстрого обнаружения бактерий, что упрощает подготовку сенсора. Существуют системы на 
основе гидрогеля, используемые для обнаружения различных биологических молекул. Эта 
техника уже хорошо себя зарекомендовала как селективный метод анализа вируса клещевого 
энцефалита.
Используется гибкий гидрогель/жидкометаллический детектор для мониторинга 
бактерий в различных средах и продуктах. Такое устройство обеспечивает более быстрый и 
дешевый количественный анализ бактерий по сравнению с существующими методами.</p>

<br>

<h1 align='center'>Выращивание Бактерий</h1>
<p align='justify'>Перед проведением эксперимента мы выращивали бактерии при температуре 37°C в бульоне 
LB в течение 24 часов. Затем, чтобы определить количество живых бактерий или 
колониеобразующих единиц (КОЕ), мы приготовили серию последовательных десятикратных 
разведений. Разведения достигались последовательным разбавлением бактериального 
инокулята в 10 пробирках, каждая из которых содержала 9 мл физиологического раствора 
(разведения в пределах от 10<sup>-1</sup> до 10<sup>-9</sup>
. Затем все разведения были посажены по 1 мл на заранее 
подготовленные стерильные пластинки с питательной средой LB, используя метод заливки, и 
инкубированы при 37°C в течение 48 часов.</p>

<p align='center'>
<img src="images/bac-growth1.png" width=250></img>
<img src="images/bac-growth2.png" width=250></img>
<img src="images/my-petri.png" width=350></img>
</p>

<br>

<h1 align='center'>Сбор Данных</h1>

<p align='justify'>
Сбор данных осуществлялся с использованием потенциостата «<b>Keithley 6430</b>». 
Обучающий набор данных был структурирован с 40 отдельными образцами для каждого 
класса. Для каждого образца записывались пять циклических вольтамперограмм (CVAs). 
Каждый набор электрохимических ответов характеризовался серией из <b>400</b> значений тока (200 
точек forward, 200 reverse). Тестовый набор данных состоял из трех образцов для каждого 
класса. В режиме изменения напряжения применялись следующие потенциальные диапазоны:

<ul>
    <li>от -0.02 до 0.02 В</li>
    <li>от -0.1 до 0.1 В</li>
    <li>от -0.5 до 0.5 В</li>
    <li>от -1 до 1 В</li>
    <li>от -5 до 5 В</li>
</ul>

</p>


<p align='center'><img src='images/vac-1.png' width=400></p>

<br>


<h1 align='center'>Обработка Данных</h1>

<p align='justify'>Полученные данные по ВАХ были собраны и предоставлены в виде таблицы формата 
*.csv (comma-separated values). Информация была обработана с помощью библиотеки для 
анализа данных Pandas. В качестве языка программирования был выбран Python 3.10.6.
Данные были разделены на две базы. Одна база данных хранила информацию о ВАХ 
кишечной палочки (<i>E. coli</i>), вторая хранила информацию о кисломолочных бактериях (<i>B.
coagulans и S. thermophilus</i>).
</p>

<p align='center'><img src='images/df-example.png' width=600></img></p>
<p align='right'>Для Концетрации (Compound)</p>

<br>

<p align='justify'>Мы решили применить «<b>UnderSampling</b>» в целях предотвращения классового дисбаланса
(явление, при котором количество объектов одного класса больше, чем количество объектов 
других классов). Другими словами, мы убрали дисбаланс, сократив количество объектов 
превосходствующего типа до наименьшего значения, уровняв количество объектов по всем 
данным:</p>

<p align='center'><img src='images/undersampling.png' width=500></img></p>